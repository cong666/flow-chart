<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>diagrams.net</title>
<meta http-equiv="refresh" content="0;URL='https://app.diagrams.net/#Hcong666%2Fflow-chart%2Fmain%2F%E8%AE%A2%E5%8D%95%E6%B1%A0-%E5%91%BD%E4%B8%AD%E5%BA%93%E5%AD%98.drawio.html'"/>
<meta charset="utf-8"/>
</head>
<body>
<div class="mxgraph" style="max-width:100%;border:1px solid transparent;" data-mxgraph="{&quot;highlight&quot;:&quot;#0000ff&quot;,&quot;nav&quot;:true,&quot;resize&quot;:true,&quot;xml&quot;:&quot;&lt;mxfile host=\&quot;app.diagrams.net\&quot; modified=\&quot;2022-08-27T22:07:29.172Z\&quot; agent=\&quot;5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0.3 Safari/605.1.15\&quot; etag=\&quot;X2RomZaVreu3FMzDMz__\&quot; version=\&quot;20.2.3\&quot; type=\&quot;github\&quot;&gt;&lt;diagram id=\&quot;9ivNilMVaMPMlek8G4Ov\&quot; name=\&quot;第 1 页\&quot;&gt;&lt;mxGraphModel dx=\&quot;1773\&quot; dy=\&quot;620\&quot; grid=\&quot;1\&quot; gridSize=\&quot;10\&quot; guides=\&quot;1\&quot; tooltips=\&quot;1\&quot; connect=\&quot;1\&quot; arrows=\&quot;1\&quot; fold=\&quot;1\&quot; page=\&quot;1\&quot; pageScale=\&quot;1\&quot; pageWidth=\&quot;827\&quot; pageHeight=\&quot;1169\&quot; math=\&quot;0\&quot; shadow=\&quot;0\&quot;&gt;&lt;root&gt;&lt;mxCell id=\&quot;0\&quot;/&gt;&lt;mxCell id=\&quot;1\&quot; parent=\&quot;0\&quot;/&gt;&lt;mxCell id=\&quot;rNhAcFa-JploLEvUV8Jw-1\&quot; value=\&quot;\&quot; style=\&quot;ellipse;whiteSpace=wrap;html=1;opacity=40;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;-40\&quot; y=\&quot;50\&quot; width=\&quot;970\&quot; height=\&quot;400\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;rNhAcFa-JploLEvUV8Jw-3\&quot; value=\&quot;&amp;lt;pre style=&amp;quot;text-align: start; background-color: rgb(43, 43, 43); color: rgb(169, 183, 198); font-family: &amp;amp;quot;JetBrains Mono&amp;amp;quot;, monospace; font-size: 9.8pt;&amp;quot;&amp;gt;stationConfig&amp;lt;/pre&amp;gt;\&quot; style=\&quot;ellipse;whiteSpace=wrap;html=1;opacity=40;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;90\&quot; y=\&quot;130\&quot; width=\&quot;120\&quot; height=\&quot;80\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;rNhAcFa-JploLEvUV8Jw-12\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;rNhAcFa-JploLEvUV8Jw-4\&quot; target=\&quot;rNhAcFa-JploLEvUV8Jw-13\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;414\&quot; y=\&quot;540\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;68LCUP7gvKSo7PwZ6zpc-9\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF6666;\&quot; parent=\&quot;1\&quot; source=\&quot;rNhAcFa-JploLEvUV8Jw-4\&quot; target=\&quot;68LCUP7gvKSo7PwZ6zpc-8\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;rNhAcFa-JploLEvUV8Jw-4\&quot; value=\&quot;List&amp;amp;lt;Order&amp;amp;gt; orders : picklist的列表\&quot; style=\&quot;ellipse;whiteSpace=wrap;html=1;opacity=40;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;354\&quot; y=\&quot;320\&quot; width=\&quot;120\&quot; height=\&quot;80\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;rNhAcFa-JploLEvUV8Jw-5\&quot; value=\&quot;&amp;lt;pre style=&amp;quot;text-align: start; background-color: rgb(43, 43, 43); color: rgb(169, 183, 198); font-family: &amp;amp;quot;JetBrains Mono&amp;amp;quot;, monospace; font-size: 9.8pt;&amp;quot;&amp;gt;配置的stations&amp;lt;/pre&amp;gt;\&quot; style=\&quot;ellipse;whiteSpace=wrap;html=1;opacity=40;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;400\&quot; y=\&quot;80\&quot; width=\&quot;120\&quot; height=\&quot;80\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;rNhAcFa-JploLEvUV8Jw-6\&quot; value=\&quot;根据batchcode等信息搜索出来的InventoryBin列表\&quot; style=\&quot;ellipse;whiteSpace=wrap;html=1;opacity=40;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;560\&quot; y=\&quot;110\&quot; width=\&quot;120\&quot; height=\&quot;80\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;rNhAcFa-JploLEvUV8Jw-8\&quot; value=\&quot;&amp;lt;pre style=&amp;quot;text-align: start; background-color: rgb(43, 43, 43); color: rgb(169, 183, 198); font-family: &amp;amp;quot;JetBrains Mono&amp;amp;quot;, monospace; font-size: 9.8pt;&amp;quot;&amp;gt;&amp;lt;pre style=&amp;quot;font-family: &amp;amp;quot;JetBrains Mono&amp;amp;quot;, monospace; font-size: 9.8pt;&amp;quot;&amp;gt;所有的货架（包含locationX，locationY）&amp;lt;/pre&amp;gt;&amp;lt;pre style=&amp;quot;font-family: &amp;amp;quot;JetBrains Mono&amp;amp;quot;, monospace; font-size: 9.8pt;&amp;quot;&amp;gt;Map&amp;amp;lt;String&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;, &amp;lt;/span&amp;gt;Shelf&amp;amp;gt; shelves&amp;lt;/pre&amp;gt;&amp;lt;/pre&amp;gt;\&quot; style=\&quot;ellipse;whiteSpace=wrap;html=1;opacity=40;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;90\&quot; y=\&quot;220\&quot; width=\&quot;300\&quot; height=\&quot;80\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;rNhAcFa-JploLEvUV8Jw-9\&quot; value=\&quot;&amp;lt;pre style=&amp;quot;text-align: start; background-color: rgb(43, 43, 43); color: rgb(169, 183, 198); font-family: &amp;amp;quot;JetBrains Mono&amp;amp;quot;, monospace; font-size: 9.8pt;&amp;quot;&amp;gt;key ：shelf， value ： 被库存占用的bin数量&amp;lt;/pre&amp;gt;&amp;lt;pre style=&amp;quot;text-align: start; background-color: rgb(43, 43, 43); color: rgb(169, 183, 198); font-family: &amp;amp;quot;JetBrains Mono&amp;amp;quot;, monospace; font-size: 9.8pt;&amp;quot;&amp;gt;Map&amp;amp;lt;String&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;, &amp;lt;/span&amp;gt;Integer&amp;amp;gt; shelfSidesNum&amp;lt;/pre&amp;gt;\&quot; style=\&quot;ellipse;whiteSpace=wrap;html=1;opacity=40;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;420\&quot; y=\&quot;210\&quot; width=\&quot;420\&quot; height=\&quot;100\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;rNhAcFa-JploLEvUV8Jw-11\&quot; value=\&quot;订单池\&quot; style=\&quot;text;html=1;strokeColor=#82b366;fillColor=#d5e8d4;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;opacity=40;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;250\&quot; y=\&quot;90\&quot; width=\&quot;60\&quot; height=\&quot;30\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;68LCUP7gvKSo7PwZ6zpc-11\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontColor=#FF6666;\&quot; parent=\&quot;1\&quot; source=\&quot;rNhAcFa-JploLEvUV8Jw-13\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;-200\&quot; y=\&quot;720\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;Array as=\&quot;points\&quot;&gt;&lt;mxPoint x=\&quot;415\&quot; y=\&quot;630\&quot;/&gt;&lt;mxPoint x=\&quot;-200\&quot; y=\&quot;630\&quot;/&gt;&lt;/Array&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;rNhAcFa-JploLEvUV8Jw-13\&quot; value=\&quot;根据picklist 的优先级分组并按照priority从大到小排序，先优先处理优先级高的订单来首先命中库存\&quot; style=\&quot;ellipse;whiteSpace=wrap;html=1;opacity=40;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;320\&quot; y=\&quot;500\&quot; width=\&quot;190\&quot; height=\&quot;110\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;68LCUP7gvKSo7PwZ6zpc-5\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;68LCUP7gvKSo7PwZ6zpc-2\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;500\&quot; y=\&quot;985\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;68LCUP7gvKSo7PwZ6zpc-2\&quot; value=\&quot;&amp;lt;p style=&amp;quot;margin: 0px; font-stretch: normal; font-size: 11px; line-height: normal; font-family: &amp;amp;quot;Helvetica Neue&amp;amp;quot;;&amp;quot;&amp;gt;根据不同的命中策略order_pool_strategy 来命中库存，&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;margin: 0px; font-stretch: normal; font-size: 11px; line-height: normal; font-family: &amp;amp;quot;Helvetica Neue&amp;amp;quot;;&amp;quot;&amp;gt;比如OrderPoolStrategyD&amp;lt;/p&amp;gt;&amp;lt;p style=&amp;quot;margin: 0px; font-stretch: normal; font-size: 11px; line-height: normal; font-family: &amp;amp;quot;Helvetica Neue&amp;amp;quot;;&amp;quot;&amp;gt;三个orderpool分别在for循环中一个一个的处理&amp;lt;/p&amp;gt;\&quot; style=\&quot;ellipse;whiteSpace=wrap;html=1;opacity=40;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;190\&quot; y=\&quot;930\&quot; width=\&quot;190\&quot; height=\&quot;110\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;68LCUP7gvKSo7PwZ6zpc-8\&quot; value=\&quot;&amp;lt;pre style=&amp;quot;text-align: start; background-color: rgb(43, 43, 43); font-family: &amp;amp;quot;JetBrains Mono&amp;amp;quot;, monospace; font-size: 9.8pt;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;public &amp;lt;/span&amp;gt;&amp;lt;font color=&amp;quot;#a9b7c6&amp;quot;&amp;gt;Order &amp;lt;/font&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(255, 198, 109);&amp;quot;&amp;gt;createOrder&amp;lt;/span&amp;gt;&amp;lt;font color=&amp;quot;#a9b7c6&amp;quot;&amp;gt;(PickList picklist) {&amp;lt;br&amp;gt;    Order order = &amp;lt;/font&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;new &amp;lt;/span&amp;gt;&amp;lt;font color=&amp;quot;#a9b7c6&amp;quot;&amp;gt;Order()&amp;lt;/font&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;;&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;    &amp;lt;/span&amp;gt;&amp;lt;font color=&amp;quot;#a9b7c6&amp;quot;&amp;gt;order.setOrderNo(picklist.getPickListNo())&amp;lt;/font&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;;&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;    &amp;lt;/span&amp;gt;&amp;lt;font color=&amp;quot;#a9b7c6&amp;quot;&amp;gt;order.setOrderTime(&amp;lt;/font&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;new &amp;lt;/span&amp;gt;&amp;lt;font color=&amp;quot;#a9b7c6&amp;quot;&amp;gt;Date(picklist.getGenerateTime()))&amp;lt;/font&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;;&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;    &amp;lt;/span&amp;gt;&amp;lt;font color=&amp;quot;#a9b7c6&amp;quot;&amp;gt;order.getDetails().addAll(toOrderDetails(picklist.getDetails()))&amp;lt;/font&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;;&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;    &amp;lt;/span&amp;gt;&amp;lt;font color=&amp;quot;#ff6666&amp;quot;&amp;gt;order.setPickList(picklist);&amp;lt;/font&amp;gt;&amp;lt;font color=&amp;quot;#cc7832&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;    &amp;lt;/span&amp;gt;&amp;lt;font color=&amp;quot;#a9b7c6&amp;quot;&amp;gt;order.setPayTime(picklist.getPayTime())&amp;lt;/font&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;;&amp;lt;/span&amp;gt;&amp;lt;/pre&amp;gt;\&quot; style=\&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;-350\&quot; y=\&quot;430\&quot; width=\&quot;560\&quot; height=\&quot;140\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;68LCUP7gvKSo7PwZ6zpc-10\&quot; value=\&quot;一个picklist对应一个&amp;lt;br&amp;gt;Order\&quot; style=\&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontColor=#FF6666;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;-200\&quot; y=\&quot;380\&quot; width=\&quot;130\&quot; height=\&quot;40\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;68LCUP7gvKSo7PwZ6zpc-13\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.364;entryDx=0;entryDy=0;entryPerimeter=0;fontSize=20;fontColor=#FF6666;\&quot; parent=\&quot;1\&quot; source=\&quot;68LCUP7gvKSo7PwZ6zpc-12\&quot; target=\&quot;68LCUP7gvKSo7PwZ6zpc-2\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;68LCUP7gvKSo7PwZ6zpc-12\&quot; value=\&quot;&amp;lt;font style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;Order按照优先级分组，比如下面的order对应的优先级 ：&amp;amp;nbsp;&amp;lt;br&amp;gt;order1 ： 5， order2 ： 5， order3 ： 4， order4 ： 2&amp;lt;br&amp;gt;分组之后并按照优先级从大到小排序 生成如下三组 ：&amp;amp;nbsp;&amp;lt;br&amp;gt;group1 ： order1，order2&amp;lt;br&amp;gt;group2 ： order3&amp;lt;br&amp;gt;group3 ： order4&amp;lt;br&amp;gt;每一组分别有多个picklist（一个Order对象对应一个Picklist）&amp;lt;br&amp;gt;将这些分组分别存到订单池中，创建多个订单池，一个订单池对应一个分组 ：&amp;amp;nbsp;&amp;lt;br&amp;gt;OrderPoolContext1.orders = group1&amp;lt;br&amp;gt;OrderPoolContext2.orders = group2&amp;lt;br&amp;gt;OrderPoolContext3.orders = group3&amp;lt;br&amp;gt;然后针对上面三个orderpool 依次在for循环中遍历处理每一个订单池并执行命中策略来处理每个订单池中的订单Picklist列表&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontColor=#FF6666;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;-460\&quot; y=\&quot;720\&quot; width=\&quot;510\&quot; height=\&quot;480\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;68LCUP7gvKSo7PwZ6zpc-16\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=20;fontColor=#FF6666;\&quot; parent=\&quot;1\&quot; source=\&quot;68LCUP7gvKSo7PwZ6zpc-14\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;&lt;mxPoint x=\&quot;750\&quot; y=\&quot;1135\&quot; as=\&quot;targetPoint\&quot;/&gt;&lt;/mxGeometry&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;68LCUP7gvKSo7PwZ6zpc-14\&quot; value=\&quot;&amp;lt;pre style=&amp;quot;text-align: start; background-color: rgb(43, 43, 43); color: rgb(169, 183, 198); font-family: &amp;amp;quot;JetBrains Mono&amp;amp;quot;, monospace; font-size: 9.8pt;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(98, 151, 85); font-style: italic;&amp;quot;&amp;gt;查找空闲播种位最多的工作站&amp;lt;/span&amp;gt;&amp;lt;/pre&amp;gt;&amp;lt;pre style=&amp;quot;caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); text-align: start; background-color: rgb(43, 43, 43); font-family: &amp;amp;quot;JetBrains Mono&amp;amp;quot;, monospace; font-size: 9.8pt;&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#629755&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;caret-color: rgb(98, 151, 85);&amp;quot;&amp;gt;&amp;lt;i&amp;gt;并加载当前工作站上unfetchedshelf列表&amp;lt;/i&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/pre&amp;gt;&amp;lt;pre style=&amp;quot;caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); text-align: start; background-color: rgb(43, 43, 43); font-family: &amp;amp;quot;JetBrains Mono&amp;amp;quot;, monospace; font-size: 9.8pt;&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#629755&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;caret-color: rgb(98, 151, 85);&amp;quot;&amp;gt;&amp;lt;i&amp;gt;（还没有做完的picklist对应的货架列表，这部分货架有可能有的已经在工作站，&amp;lt;/i&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/pre&amp;gt;&amp;lt;pre style=&amp;quot;caret-color: rgb(0, 0, 0); color: rgb(0, 0, 0); text-align: start; background-color: rgb(43, 43, 43); font-family: &amp;amp;quot;JetBrains Mono&amp;amp;quot;, monospace; font-size: 9.8pt;&amp;quot;&amp;gt;&amp;lt;font color=&amp;quot;#629755&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;caret-color: rgb(98, 151, 85);&amp;quot;&amp;gt;&amp;lt;i&amp;gt;有的在来工作站的路上）&amp;lt;/i&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/pre&amp;gt;\&quot; style=\&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=20;fontColor=#FF6666;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;500\&quot; y=\&quot;915\&quot; width=\&quot;500\&quot; height=\&quot;140\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;68LCUP7gvKSo7PwZ6zpc-24\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.556;entryY=-0.006;entryDx=0;entryDy=0;entryPerimeter=0;fontSize=21;fontColor=#FF6666;\&quot; parent=\&quot;1\&quot; source=\&quot;68LCUP7gvKSo7PwZ6zpc-17\&quot; target=\&quot;68LCUP7gvKSo7PwZ6zpc-23\&quot; edge=\&quot;1\&quot;&gt;&lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;68LCUP7gvKSo7PwZ6zpc-17\&quot; value=\&quot;比如此处我们选择工作站station1，station1上有三个货架shelfatstation1&amp;lt;br&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;shelfatstation2，shelfatstation3，还有一个货架在来的路上shelfcomming4&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;每个shelf中会计算一个score这个score是station1和shelf位置的曼哈顿距离，&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;shelf列表会根据这个scroe从小到大排序，目的是系统要优先命中靠近工作站近的货架&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;1. 首先过滤库存inventoryBin列表来筛选出在shelfatstation1，&amp;lt;/div&amp;gt;shelfatstation2，shelfatstation3，shelfcoming4 这些货架上的库存来优先命中&amp;amp;nbsp;&amp;lt;br&amp;gt;&amp;lt;font&amp;gt;2. 根据策略&amp;lt;span style=&amp;quot;font-size: 20px; font-family: &amp;amp;quot;Helvetica Neue&amp;amp;quot;;&amp;quot;&amp;gt;&amp;lt;font style=&amp;quot;font-size: 20px;&amp;quot;&amp;gt;t_strategy_allocate_detail中的货架类型：shelf_type ,库区id ：warehouse_id&amp;lt;br&amp;gt;来过滤库存&amp;lt;br&amp;gt;3. &amp;amp;nbsp;继续根据策略来对上面过滤出的库存进行排序：&amp;lt;br&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;清空货位 ： 按照库存数量从小到大排序，库存数量相等的按照货架距离工作站的距离从小到大排序&amp;lt;br&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp;最小任务 ： 将清空货位的排序反过来&amp;lt;br&amp;gt;4. 对第一个订单池OrderPoolContext1中的picklistdetail进行命中库存，修改内存中inventorybin的availablenum - hitNum&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;5. 返回目标订单 ： 即成功命中库存的订单&amp;lt;br&amp;gt;6. 将订单分配到该工作站：&amp;lt;br&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;pre style=&amp;quot;font-size: 9.8pt; background-color: rgb(43, 43, 43); color: rgb(169, 183, 198); font-family: &amp;amp;quot;JetBrains Mono&amp;amp;quot;, monospace;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(98, 151, 85); font-style: italic;&amp;quot;&amp;gt;/**&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(98, 151, 85); font-style: italic;&amp;quot;&amp;gt; * 将订单分配到工作站&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(98, 151, 85); font-style: italic;&amp;quot;&amp;gt; */&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;private void &amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(255, 198, 109);&amp;quot;&amp;gt;allotOrderToStation&amp;lt;/span&amp;gt;(Order order&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;, &amp;lt;/span&amp;gt;Station idlestStation&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;, &amp;lt;/span&amp;gt;OrderPoolContext context&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;,&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;        &amp;lt;/span&amp;gt;Map&amp;amp;lt;String&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;, &amp;lt;/span&amp;gt;List&amp;amp;lt;InventoryBinRich&amp;amp;gt;&amp;amp;gt; inventoryMap) {&amp;lt;br&amp;gt;    &amp;lt;span style=&amp;quot;color: rgb(128, 128, 128);&amp;quot;&amp;gt;// 命中最优订单&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(128, 128, 128);&amp;quot;&amp;gt;    &amp;lt;/span&amp;gt;OrderHit hit = createOrderHit(order&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;, &amp;lt;/span&amp;gt;idlestStation)&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;;&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;    &amp;lt;/span&amp;gt;context.getOrderHits().add(hit)&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;;&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;    &amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(128, 128, 128);&amp;quot;&amp;gt;// 更新库存可用数量&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(128, 128, 128);&amp;quot;&amp;gt;    &amp;lt;/span&amp;gt;updateInventory(getInventoryHitByOrder(order)&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;, &amp;lt;/span&amp;gt;inventoryMap)&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;;&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;    &amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(128, 128, 128);&amp;quot;&amp;gt;// 更新工作站的空闲播种位&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(128, 128, 128);&amp;quot;&amp;gt;    &amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;int &amp;lt;/span&amp;gt;idleBinsNum = idlestStation.getIdleSeedingBinNum()&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;;&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;    &amp;lt;/span&amp;gt;idlestStation.setIdleSeedingBinNum(idleBinsNum - &amp;lt;span style=&amp;quot;color: rgb(104, 151, 187);&amp;quot;&amp;gt;1&amp;lt;/span&amp;gt;)&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;;&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;    &amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(128, 128, 128);&amp;quot;&amp;gt;// 把命中订单的货架加入到工作站的货架池中&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(128, 128, 128);&amp;quot;&amp;gt;    &amp;lt;/span&amp;gt;idlestStation.getShelves().addAll(hit.getShelves())&amp;lt;span style=&amp;quot;color: rgb(204, 120, 50);&amp;quot;&amp;gt;;&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;}&amp;lt;/pre&amp;gt;&amp;lt;pre&amp;gt;&amp;lt;font face=&amp;quot;Helvetica Neue&amp;quot;&amp;gt;将该工作站的空闲播种位减一，并将命中的货架加入当前工作站的货架池中&amp;lt;/font&amp;gt;&amp;lt;/pre&amp;gt;&amp;lt;pre&amp;gt;&amp;lt;font face=&amp;quot;Helvetica Neue&amp;quot;&amp;gt;7.然后将命中完的订单从订单池中移除&amp;lt;/font&amp;gt;&amp;lt;/pre&amp;gt;&amp;lt;pre&amp;gt;&amp;lt;font face=&amp;quot;Helvetica Neue&amp;quot;&amp;gt;8.继续处理没有命中成功的picklistdetail，因为工作站的货架池中的货架上可能不会包含所有我们想要&amp;lt;/font&amp;gt;&amp;lt;/pre&amp;gt;&amp;lt;pre&amp;gt;&amp;lt;font face=&amp;quot;Helvetica Neue&amp;quot;&amp;gt;命中的库存，所以这里继续命中货架池之外仓库区域中的货架，直到所有订单都被命中&amp;lt;/font&amp;gt;&amp;lt;/pre&amp;gt;&amp;lt;pre&amp;gt;&amp;lt;font face=&amp;quot;Helvetica Neue&amp;quot;&amp;gt;8.此时完成第一个订单池 OrderPoolContext1的处理，后面重复上面的步骤来一次命中其余两个订单池中&amp;lt;/font&amp;gt;&amp;lt;/pre&amp;gt;&amp;lt;pre&amp;gt;&amp;lt;font face=&amp;quot;Helvetica Neue&amp;quot;&amp;gt;的订单&amp;lt;/font&amp;gt;&amp;lt;span style=&amp;quot;font-family: &amp;amp;quot;Helvetica Neue&amp;amp;quot;;&amp;quot;&amp;gt;OrderPoolContext2，&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-family: &amp;amp;quot;Helvetica Neue&amp;amp;quot;;&amp;quot;&amp;gt;OrderPoolContext3&amp;lt;/span&amp;gt;&amp;lt;/pre&amp;gt;&amp;lt;/font&amp;gt;\&quot; style=\&quot;text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=#82b366;fillColor=#d5e8d4;fontSize=20;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;330\&quot; y=\&quot;1150\&quot; width=\&quot;1080\&quot; height=\&quot;930\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;68LCUP7gvKSo7PwZ6zpc-22\&quot; value=\&quot;&amp;lt;pre style=&amp;quot;text-align: start; background-color: rgb(43, 43, 43); color: rgb(169, 183, 198); font-family: &amp;amp;quot;JetBrains Mono&amp;amp;quot;, monospace; font-size: 9.8pt;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(232, 191, 106);&amp;quot;&amp;gt;&amp;amp;lt;select &amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(186, 186, 186);&amp;quot;&amp;gt;id&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(106, 135, 89);&amp;quot;&amp;gt;=&amp;quot;getUnfetchedShelves&amp;quot; &amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(186, 186, 186);&amp;quot;&amp;gt;resultType&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(106, 135, 89);&amp;quot;&amp;gt;=&amp;quot;java.util.HashMap&amp;quot;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(232, 191, 106);&amp;quot;&amp;gt;&amp;amp;gt;&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(232, 191, 106);&amp;quot;&amp;gt;  &amp;lt;/span&amp;gt;select distinct a.workstation_no, substr(b.bin_code,1,7) shelf_code&amp;lt;br&amp;gt;  from t_pick_list a, t_pick_task b&amp;lt;br&amp;gt;  where 1=1&amp;lt;br&amp;gt;  and a.status != 141&amp;lt;br&amp;gt;  and a.workstation_no != &#39;&#39;&amp;lt;br&amp;gt;  and a.pick_list_id = b.pick_list_id&amp;lt;br&amp;gt;  and b.status != 121&amp;lt;br&amp;gt;&amp;lt;span style=&amp;quot;color: rgb(232, 191, 106);&amp;quot;&amp;gt;&amp;amp;lt;/select&amp;amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/pre&amp;gt;\&quot; style=\&quot;text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=20;fontColor=#FF6666;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;1040\&quot; y=\&quot;930\&quot; width=\&quot;560\&quot; height=\&quot;170\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;mxCell id=\&quot;68LCUP7gvKSo7PwZ6zpc-23\&quot; value=\&quot;&amp;lt;div&amp;gt;&amp;lt;font face=&amp;quot;PingFang SC&amp;quot; color=&amp;quot;#474747&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;caret-color: rgb(71, 71, 71); font-size: 21px;&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/font&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;ul style=&amp;quot;font-size: 21px;&amp;quot;&amp;gt;&amp;lt;li style=&amp;quot;margin: 0px 0px 10px; font-stretch: normal; line-height: normal; color: rgb(71, 71, 71); -webkit-text-stroke-width: initial; -webkit-text-stroke-color: rgb(0, 0, 0);&amp;quot;&amp;gt;&amp;lt;font face=&amp;quot;PingFang SC&amp;quot;&amp;gt;创建picktask（一个picktask对应一个picklistdetail）&amp;lt;/font&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;li style=&amp;quot;margin: 0px 0px 10px; font-stretch: normal; line-height: normal; color: rgb(71, 71, 71); -webkit-text-stroke-width: initial; -webkit-text-stroke-color: rgb(0, 0, 0);&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-stretch: normal; line-height: normal; font-family: Arial;&amp;quot;&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-stretch: normal; line-height: normal; font-family: &amp;amp;quot;PingFang SC&amp;amp;quot;; font-variant-ligatures: no-common-ligatures;&amp;quot;&amp;gt;更新&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-variant-ligatures: no-common-ligatures&amp;quot;&amp;gt;t_pick_list&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-stretch: normal; line-height: normal; font-family: &amp;amp;quot;PingFang SC&amp;amp;quot;; font-variant-ligatures: no-common-ligatures;&amp;quot;&amp;gt;（拣选单主表）&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-variant-ligatures: no-common-ligatures&amp;quot;&amp;gt;status&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-stretch: normal; line-height: normal; font-family: &amp;amp;quot;PingFang SC&amp;amp;quot;; font-variant-ligatures: no-common-ligatures;&amp;quot;&amp;gt;为&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-variant-ligatures: no-common-ligatures&amp;quot;&amp;gt;131&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-stretch: normal; line-height: normal; font-family: &amp;amp;quot;PingFang SC&amp;amp;quot;; font-variant-ligatures: no-common-ligatures;&amp;quot;&amp;gt;（创建拣选任务成功），&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-variant-ligatures: no-common-ligatures&amp;quot;&amp;gt;workstation_no&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-stretch: normal; line-height: normal; font-family: &amp;amp;quot;PingFang SC&amp;amp;quot;; font-variant-ligatures: no-common-ligatures;&amp;quot;&amp;gt;，&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-variant-ligatures: no-common-ligatures&amp;quot;&amp;gt;seeding_bin_no&amp;lt;/span&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;li style=&amp;quot;margin: 0px; font-stretch: normal; line-height: normal; color: rgb(71, 71, 71); -webkit-text-stroke-width: initial; -webkit-text-stroke-color: rgb(0, 0, 0);&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-stretch: normal; line-height: normal; font-family: Arial;&amp;quot;&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-stretch: normal; line-height: normal; font-family: &amp;amp;quot;PingFang SC&amp;amp;quot;; font-variant-ligatures: no-common-ligatures;&amp;quot;&amp;gt;更新&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-variant-ligatures: no-common-ligatures&amp;quot;&amp;gt;t_pick_order&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-stretch: normal; line-height: normal; font-family: &amp;amp;quot;PingFang SC&amp;amp;quot;; font-variant-ligatures: no-common-ligatures;&amp;quot;&amp;gt;（拣货工作表）&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-variant-ligatures: no-common-ligatures&amp;quot;&amp;gt;status&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-stretch: normal; line-height: normal; font-family: &amp;amp;quot;PingFang SC&amp;amp;quot;; font-variant-ligatures: no-common-ligatures;&amp;quot;&amp;gt;为&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-variant-ligatures: no-common-ligatures&amp;quot;&amp;gt;112&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-stretch: normal; line-height: normal; font-family: &amp;amp;quot;PingFang SC&amp;amp;quot;; font-variant-ligatures: no-common-ligatures;&amp;quot;&amp;gt;（分配工作站完成）&amp;lt;/span&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;li style=&amp;quot;margin: 0px; font-stretch: normal; line-height: normal; color: rgb(71, 71, 71); -webkit-text-stroke-width: initial; -webkit-text-stroke-color: rgb(0, 0, 0);&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;-webkit-text-stroke-width: initial; font-family: &amp;amp;quot;JetBrains Mono&amp;amp;quot;, monospace; background-color: rgb(43, 43, 43); font-size: 20px; color: rgb(152, 118, 170);&amp;quot;&amp;gt;调用inventoryApiService&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;-webkit-text-stroke-width: initial; color: rgb(169, 183, 198); font-family: &amp;amp;quot;JetBrains Mono&amp;amp;quot;, monospace; background-color: rgb(43, 43, 43); font-size: 20px;&amp;quot;&amp;gt;.updatePreAllocationNumToAllocationNum 方法来修改库位库存：&amp;lt;span style=&amp;quot;white-space: pre;&amp;quot;&amp;gt; &amp;lt;/span&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;li style=&amp;quot;margin: 0px 0px 10px; font-stretch: normal; font-size: 11px; line-height: normal; color: rgb(71, 71, 71); -webkit-text-stroke-width: initial; -webkit-text-stroke-color: rgb(0, 0, 0);&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-stretch: normal; line-height: normal; font-family: Arial;&amp;quot;&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-stretch: normal; line-height: normal; font-family: &amp;amp;quot;PingFang SC&amp;amp;quot;; font-variant-ligatures: no-common-ligatures;&amp;quot;&amp;gt;更新&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-variant-ligatures: no-common-ligatures&amp;quot;&amp;gt;t_inventory_bin&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-stretch: normal; line-height: normal; font-family: &amp;amp;quot;PingFang SC&amp;amp;quot;; font-variant-ligatures: no-common-ligatures;&amp;quot;&amp;gt;（库位库存）&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-variant-ligatures: no-common-ligatures&amp;quot;&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; available_num&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-stretch: normal; line-height: normal; font-family: &amp;amp;quot;PingFang SC&amp;amp;quot;; font-variant-ligatures: no-common-ligatures;&amp;quot;&amp;gt;（可用数量）&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-variant-ligatures: no-common-ligatures&amp;quot;&amp;gt;-&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-stretch: normal; line-height: normal; font-family: &amp;amp;quot;PingFang SC&amp;amp;quot;; font-variant-ligatures: no-common-ligatures;&amp;quot;&amp;gt;拣选单需求数&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-variant-ligatures: no-common-ligatures&amp;quot;&amp;gt;.&amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; &amp;amp;nbsp; allocation_num &amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-stretch: normal; line-height: normal; font-family: &amp;amp;quot;PingFang SC&amp;amp;quot;; font-variant-ligatures: no-common-ligatures;&amp;quot;&amp;gt;（命中数量）&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-variant-ligatures: no-common-ligatures&amp;quot;&amp;gt;+&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-stretch: normal; line-height: normal; font-family: &amp;amp;quot;PingFang SC&amp;amp;quot;; font-variant-ligatures: no-common-ligatures;&amp;quot;&amp;gt;拣选单需求数&amp;lt;/span&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;br/&amp;gt;&amp;lt;li style=&amp;quot;margin: 0px; font-stretch: normal; font-size: 11px; line-height: normal; color: rgb(71, 71, 71); -webkit-text-stroke-width: initial; -webkit-text-stroke-color: rgb(0, 0, 0);&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;font-stretch: normal; line-height: normal; font-family: Arial;&amp;quot;&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-stretch: normal; line-height: normal; font-family: &amp;amp;quot;PingFang SC&amp;amp;quot;; font-variant-ligatures: no-common-ligatures;&amp;quot;&amp;gt;更新&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-variant-ligatures: no-common-ligatures&amp;quot;&amp;gt;t_inventory_area&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-stretch: normal; line-height: normal; font-family: &amp;amp;quot;PingFang SC&amp;amp;quot;; font-variant-ligatures: no-common-ligatures;&amp;quot;&amp;gt;（库区库存）&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-variant-ligatures: no-common-ligatures&amp;quot;&amp;gt;pre_allocation_num&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-stretch: normal; line-height: normal; font-family: &amp;amp;quot;PingFang SC&amp;amp;quot;; font-variant-ligatures: no-common-ligatures;&amp;quot;&amp;gt;（预分配数）&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-variant-ligatures: no-common-ligatures&amp;quot;&amp;gt;-&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-stretch: normal; line-height: normal; font-family: &amp;amp;quot;PingFang SC&amp;amp;quot;; font-variant-ligatures: no-common-ligatures;&amp;quot;&amp;gt;拣选单需求数&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-variant-ligatures: no-common-ligatures&amp;quot;&amp;gt;allocation_num &amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-stretch: normal; line-height: normal; font-family: &amp;amp;quot;PingFang SC&amp;amp;quot;; font-variant-ligatures: no-common-ligatures;&amp;quot;&amp;gt;（命中数量）&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-variant-ligatures: no-common-ligatures&amp;quot;&amp;gt;+&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;font-stretch: normal; line-height: normal; font-family: &amp;amp;quot;PingFang SC&amp;amp;quot;; font-variant-ligatures: no-common-ligatures;&amp;quot;&amp;gt;拣选单需求数&amp;lt;/span&amp;gt;&amp;lt;/li&amp;gt;&amp;lt;/ul&amp;gt;\&quot; style=\&quot;text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=#82b366;fillColor=#d5e8d4;fontSize=20;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;&lt;mxGeometry x=\&quot;302\&quot; y=\&quot;2130\&quot; width=\&quot;1020\&quot; height=\&quot;280\&quot; as=\&quot;geometry\&quot;/&gt;&lt;/mxCell&gt;&lt;/root&gt;&lt;/mxGraphModel&gt;&lt;/diagram&gt;&lt;/mxfile&gt;&quot;,&quot;toolbar&quot;:&quot;pages zoom layers lightbox&quot;,&quot;page&quot;:0}"></div>
<a style="position:absolute;top:50%;left:50%;margin-top:-128px;margin-left:-64px;" href="https://app.diagrams.net/#Hcong666%2Fflow-chart%2Fmain%2F%E8%AE%A2%E5%8D%95%E6%B1%A0-%E5%91%BD%E4%B8%AD%E5%BA%93%E5%AD%98.drawio.html" target="_blank"><img border="0" src="https://app.diagrams.net/images/drawlogo128.png"/></a>
</body>
</html>
